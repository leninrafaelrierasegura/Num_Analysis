"0","# Precompute the LHS matrix"
"0","LHS <- Pr + time_step * solve(C, Pl)"
"0","# Initialize U matrix to store solution at each time step"
"0","U_approx <- matrix(NA, nrow = nrow(C), ncol = length(time_seq))"
"0","U_approx[, 1] <- U_0"
"0",""
"0","# Time-stepping loop"
"0","for (k in 1:(length(time_seq) - 1)) {"
"0","  RHS <- Pr %*% U_approx[, k]"
"0","  U_approx[, k + 1] <- as.matrix(solve(LHS, RHS))"
"0","}"
